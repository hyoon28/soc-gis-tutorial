<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Emplacing Demographic Data | Spatial Data and Mapping for Sociologists</title>
  <meta name="description" content="This is a website with tutorials for Advanced Quantitative Methods in Contemporary Sociology’s Spatial Data and Mapping module." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Emplacing Demographic Data | Spatial Data and Mapping for Sociologists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a website with tutorials for Advanced Quantitative Methods in Contemporary Sociology’s Spatial Data and Mapping module." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Emplacing Demographic Data | Spatial Data and Mapping for Sociologists" />
  
  <meta name="twitter:description" content="This is a website with tutorials for Advanced Quantitative Methods in Contemporary Sociology’s Spatial Data and Mapping module." />
  

<meta name="author" content="Hesu Yoon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="from-people-to-built-environment.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SOC-GIS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#spatial-data-and-analysis"><i class="fa fa-check"></i><b>1.1</b> Spatial Data and Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html"><i class="fa fa-check"></i><b>2</b> Emplacing Demographic Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#defining-boundaries"><i class="fa fa-check"></i><b>2.1</b> Defining boundaries</a></li>
<li class="chapter" data-level="2.2" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#joining-attributes"><i class="fa fa-check"></i><b>2.2</b> Joining attributes</a></li>
<li class="chapter" data-level="2.3" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#data-visualization"><i class="fa fa-check"></i><b>2.3</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#choropleth-map"><i class="fa fa-check"></i><b>2.3.1</b> Choropleth map</a></li>
<li class="chapter" data-level="2.3.2" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#typology-map"><i class="fa fa-check"></i><b>2.3.2</b> Typology map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html"><i class="fa fa-check"></i><b>3</b> From People to Built Environment</a>
<ul>
<li class="chapter" data-level="3.1" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#transforming-airbnbs"><i class="fa fa-check"></i><b>3.1</b> Transforming Airbnbs</a></li>
<li class="chapter" data-level="3.2" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#geocoding-restaurants"><i class="fa fa-check"></i><b>3.2</b> Geocoding Restaurants</a></li>
<li class="chapter" data-level="3.3" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#distribution-and-density"><i class="fa fa-check"></i><b>3.3</b> Distribution and density</a></li>
<li class="chapter" data-level="3.4" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#spatial-join"><i class="fa fa-check"></i><b>3.4</b> Spatial join</a></li>
<li class="chapter" data-level="3.5" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#export-maps"><i class="fa fa-check"></i><b>3.5</b> Export Maps</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="accounting-for-regulations.html"><a href="accounting-for-regulations.html"><i class="fa fa-check"></i><b>4</b> Accounting for Regulations</a>
<ul>
<li class="chapter" data-level="4.1" data-path="accounting-for-regulations.html"><a href="accounting-for-regulations.html#spatial-functions"><i class="fa fa-check"></i><b>4.1</b> Spatial functions</a></li>
<li class="chapter" data-level="4.2" data-path="accounting-for-regulations.html"><a href="accounting-for-regulations.html#constructing-geometry"><i class="fa fa-check"></i><b>4.2</b> Constructing Geometry</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="additional-topics.html"><a href="additional-topics.html"><i class="fa fa-check"></i><b>5</b> Additional Topics</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data and Mapping for Sociologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="emplacing-demographic-data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Emplacing Demographic Data<a href="emplacing-demographic-data.html#emplacing-demographic-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we will discuss demographic data nested in places, which is often used in sociological research. Sociologists often study where people live and move to. Topics like migration, segregation, gentrification, integration/assimilation, and diversity/fractionalization can be studied using aggregated demographic data for a given geographic unit. As a first step, defining a geographic unit and boundary suitable for your analysis is critical.</p>
<div id="defining-boundaries" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Defining boundaries<a href="emplacing-demographic-data.html#defining-boundaries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Geographic boundaries can be defined and drawn at various levels, from regions to cities to neighborhoods. Territories are contested and (re)defined through social processes, therefore, it is important to clearly define and justify your choice of spatial boundary as a unit of analysis. Common topics studied by urban sociologists, for instance, often involves neighborhood dynamics. But what are neighborhoods? While government-defined census tracts are often used as a proxy for neighborhoods in quantitative social science research, some scholars choose to analyze other types of boundaries, such as “community areas” that are more meaningful to its residents.</p>
<p><strong>THE CASE OF SAN FRANCISCO</strong></p>
<p>Let’s demonstrate the importance of defining neighborhood boundaries using the case of San Francisco. San Francisco’s neighborhood names and boundaries have changed over time <a href="https://www.sfgate.com/places/article/What-did-your-neighborhood-used-to-be-called-15098783.php">(1)</a> and the current names and boundaries are often inconsistently perceived and administered <a href="https://www.sfchronicle.com/projects/2022/san-francisco-neighborhoods/">(2)</a>. The image below, for example, compares the old and current neighborhood names and boundaries in San Francisco.</p>
<div class="figure">
<img src="images/sf-name-change.png" alt="" />
<p class="caption">Source: SFGATE</p>
</div>
<p>In this tutorial, we will learn how to visualize San Francisco neighborhoods based on census tracts as well as the “Analysis Neighborhood” created by the city officials. Many US city governments provide their local data through Open Data websites, including San Francisco’s <a href="https://datasf.org/opendata/">DataSF</a>. Open their website and then click the “Geographic Locations &amp; Boundaries” tab.</p>
<div class="figure">
<img src="images/sf-open-data.png" alt="" />
<p class="caption">DataSF is an open data website provided by the city government of San Francisco</p>
</div>
<p>Under this tab, you will find the 2010 census tract and “Analysis Neighborhood” boundaries, among many other geographic data.</p>
<ul>
<li>Geographic boundaries data can come in various formats, like geojson, shapefiles, etc.</li>
<li>In this tutorial, we use geojson files.</li>
<li>Geographic boundaries are “polygons”</li>
<li>We use <strong>sf package</strong> in R to handle spatial data.</li>
</ul>
<p>Set up and import geojson files.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="emplacing-demographic-data.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, you will have to set up by installing and calling the sf package.</span></span>
<span id="cb1-2"><a href="emplacing-demographic-data.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="emplacing-demographic-data.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import neighborhood boundaries data (polygons)</span></span>
<span id="cb2-2"><a href="emplacing-demographic-data.html#cb2-2" aria-hidden="true" tabindex="-1"></a>sfnh <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/sfnh.geojson&quot;</span>) <span class="co"># for &quot;Analysis Neighborhood&quot; boundaries</span></span>
<span id="cb2-3"><a href="emplacing-demographic-data.html#cb2-3" aria-hidden="true" tabindex="-1"></a>sftrt <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/sftrt_clean.geojson&quot;</span>) <span class="co"># for census tracts</span></span></code></pre></div>
<p>You can treat sf objects like data frames.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="emplacing-demographic-data.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overview of variables</span></span>
<span id="cb3-2"><a href="emplacing-demographic-data.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sfnh, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 3 features and 1 field
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -122.4761 ymin: 37.70833 xmax: -122.3983 ymax: 37.79037
## Geodetic CRS:  WGS 84
##                nhood                       geometry
## 1   Western Addition MULTIPOLYGON (((-122.4214 3...
## 2 West of Twin Peaks MULTIPOLYGON (((-122.461 37...
## 3  Visitacion Valley MULTIPOLYGON (((-122.4039 3...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="emplacing-demographic-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform an sf object into a simple one data frame (without geometries)</span></span>
<span id="cb5-2"><a href="emplacing-demographic-data.html#cb5-2" aria-hidden="true" tabindex="-1"></a>sfnh_wo_geo <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(sfnh)</span>
<span id="cb5-3"><a href="emplacing-demographic-data.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="emplacing-demographic-data.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sfnh_wo_geo, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                nhood
## 1   Western Addition
## 2 West of Twin Peaks
## 3  Visitacion Valley</code></pre>
<p>We can compare how San Francisco neighborhood boundaries differ by mapping them next to each other. We use ggplot for mapping.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="emplacing-demographic-data.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="emplacing-demographic-data.html#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="emplacing-demographic-data.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying geometry for &quot;analysis neighborhood&quot; boundaries</span></span>
<span id="cb7-4"><a href="emplacing-demographic-data.html#cb7-4" aria-hidden="true" tabindex="-1"></a>sfnh_geo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> sfnh) <span class="sc">+</span> <span class="co"># add a layer to the plot using spatial data</span></span>
<span id="cb7-5"><a href="emplacing-demographic-data.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>,          <span class="co"># set the fill color of the spatial features</span></span>
<span id="cb7-6"><a href="emplacing-demographic-data.html#cb7-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>,        <span class="co"># set the color of boundaries</span></span>
<span id="cb7-7"><a href="emplacing-demographic-data.html#cb7-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>           <span class="co"># set the thickness of the boundary lines</span></span>
<span id="cb7-8"><a href="emplacing-demographic-data.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()                    <span class="co"># apply no background</span></span>
<span id="cb7-9"><a href="emplacing-demographic-data.html#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="emplacing-demographic-data.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Replicate the map using census tract boundaries</span></span>
<span id="cb7-11"><a href="emplacing-demographic-data.html#cb7-11" aria-hidden="true" tabindex="-1"></a>sftrt_geo <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> sftrt) <span class="sc">+</span></span>
<span id="cb7-12"><a href="emplacing-demographic-data.html#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb7-13"><a href="emplacing-demographic-data.html#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()  </span>
<span id="cb7-14"><a href="emplacing-demographic-data.html#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="emplacing-demographic-data.html#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining maps</span></span>
<span id="cb7-16"><a href="emplacing-demographic-data.html#cb7-16" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(sfnh_geo, sftrt_geo, <span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb7-17"><a href="emplacing-demographic-data.html#cb7-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Analysis Neighborhood&quot;</span>,</span>
<span id="cb7-18"><a href="emplacing-demographic-data.html#cb7-18" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;2010 Census Tract&quot;</span>)</span>
<span id="cb7-19"><a href="emplacing-demographic-data.html#cb7-19" aria-hidden="true" tabindex="-1"></a>                  ) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/boundary-map-1.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="emplacing-demographic-data.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overlaying boundaries</span></span>
<span id="cb8-2"><a href="emplacing-demographic-data.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb8-3"><a href="emplacing-demographic-data.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sftrt, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  </span>
<span id="cb8-4"><a href="emplacing-demographic-data.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sfnh, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="emplacing-demographic-data.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()  <span class="sc">+</span></span>
<span id="cb8-6"><a href="emplacing-demographic-data.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Compare Boundaries&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/boundary-map-2.png" width="672" /></p>
<p>What differences do you see between “Analysis Neighborhood” and “Census Tract”?</p>
<p><strong>THINK AND SHARE</strong></p>
<p>Let’s consider another example of contentious geographic unit: Europe. How will you define “Europe”? Should a map of Europe include Turkey, Ukraine, Lapland, or French Guyana? Where is the center of Europe?</p>
<div class="figure">
<img src="images/europe.png" alt="" />
<p class="caption">Source: Lambert and Zanin (2020)</p>
</div>
<ul>
<li>Think of various geographic levels of analysis.</li>
<li>What questions could we ask about them?</li>
<li>How will you define their boundaries?</li>
</ul>
<p><strong>LEARN MORE</strong></p>
<p><a href="https://www.nytimes.com/interactive/2023/upshot/extremely-detailed-nyc-neighborhood-map.html">New York Times Upshot report</a> did a great job exploring New York City’s neighborhood boundaries using crowd-sourced data. They asked residents of New York City to demarcate neighborhood boundaries and identify their names. It provides a fascinating window to understand the sticky yet malleable nature of geographic boundaries.</p>
<p>Documentation for <a href="https://r-spatial.github.io/sf/">Simple Features for R (sf package)</a></p>

</div>
<div id="joining-attributes" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Joining attributes<a href="emplacing-demographic-data.html#joining-attributes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Geographic boundaries alone don’t tell us much about what is social about them. Sociologists, and social scientists more broadly, often are interested in <strong>people</strong> in these places. Therefore, matching aggregated demographic data with the geographic boundaries is a crucial next step.</p>
<p>We can merge a sf object with a data frame containing demographic attributes using the merge() function.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="emplacing-demographic-data.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import demographic attributes</span></span>
<span id="cb9-2"><a href="emplacing-demographic-data.html#cb9-2" aria-hidden="true" tabindex="-1"></a>sfdem <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/sfnh_dem.csv&quot;</span>)</span>
<span id="cb9-3"><a href="emplacing-demographic-data.html#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="emplacing-demographic-data.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check common identifier</span></span>
<span id="cb9-5"><a href="emplacing-demographic-data.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sfdem)</span></code></pre></div>
<pre><code>## [1] &quot;nhood&quot;    &quot;pwhite&quot;   &quot;pblack&quot;   &quot;pasian&quot;   &quot;phisp&quot;    &quot;pwhite17&quot; &quot;pblack17&quot;
## [8] &quot;pasian17&quot; &quot;phisp17&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="emplacing-demographic-data.html#cb11-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Yes, in both data sets, &quot;nhood&quot; exists.</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="emplacing-demographic-data.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join attributes to geometry</span></span>
<span id="cb12-2"><a href="emplacing-demographic-data.html#cb12-2" aria-hidden="true" tabindex="-1"></a>sf_joined <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb12-3"><a href="emplacing-demographic-data.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> sfnh,            <span class="co"># sf object; the returned object will be of the same type as x.</span></span>
<span id="cb12-4"><a href="emplacing-demographic-data.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> sfdem,           <span class="co"># data frame</span></span>
<span id="cb12-5"><a href="emplacing-demographic-data.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by.x =</span> <span class="st">&quot;nhood&quot;</span>,      <span class="co"># x identifier</span></span>
<span id="cb12-6"><a href="emplacing-demographic-data.html#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">by.y =</span> <span class="st">&quot;nhood&quot;</span>,      <span class="co"># y identifier</span></span>
<span id="cb12-7"><a href="emplacing-demographic-data.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>         <span class="co"># keep all lines</span></span>
<span id="cb12-8"><a href="emplacing-demographic-data.html#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-9"><a href="emplacing-demographic-data.html#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="emplacing-demographic-data.html#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Validate geometries</span></span>
<span id="cb12-11"><a href="emplacing-demographic-data.html#cb12-11" aria-hidden="true" tabindex="-1"></a>sf_joined <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(sf_joined)</span></code></pre></div>
<p>Now, we can explore neighborhood-level characteristics.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="emplacing-demographic-data.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-2"><a href="emplacing-demographic-data.html#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="emplacing-demographic-data.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the share of white population of neighborhoods</span></span>
<span id="cb13-4"><a href="emplacing-demographic-data.html#cb13-4" aria-hidden="true" tabindex="-1"></a>sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="emplacing-demographic-data.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(nhood, pwhite)</span></code></pre></div>
<pre><code>## Simple feature collection with 41 features and 2 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -122.5149 ymin: 37.70813 xmax: -122.357 ymax: 37.8333
## Geodetic CRS:  WGS 84
## First 10 features:
##                             nhood    pwhite                       geometry
## 1           Bayview Hunters Point  5.657989 MULTIPOLYGON (((-122.3816 3...
## 2                  Bernal Heights 38.517951 MULTIPOLYGON (((-122.4036 3...
## 3             Castro/Upper Market 77.062002 MULTIPOLYGON (((-122.4263 3...
## 4                       Chinatown 10.417827 MULTIPOLYGON (((-122.4067 3...
## 5                       Excelsior 16.997611 MULTIPOLYGON (((-122.4246 3...
## 6  Financial District/South Beach 60.342295 MULTIPOLYGON (((-122.3875 3...
## 7                       Glen Park 60.722712 MULTIPOLYGON (((-122.4474 3...
## 8                Golden Gate Park 66.423358 MULTIPOLYGON (((-122.4426 3...
## 9                  Haight Ashbury 74.872127 MULTIPOLYGON (((-122.4321 3...
## 10                   Hayes Valley 58.273722 MULTIPOLYGON (((-122.4207 3...</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="emplacing-demographic-data.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the neighborhood named &quot;Mission&quot;</span></span>
<span id="cb15-2"><a href="emplacing-demographic-data.html#cb15-2" aria-hidden="true" tabindex="-1"></a>sf_joined <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="emplacing-demographic-data.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhood <span class="sc">==</span> <span class="st">&quot;Mission&quot;</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 1 feature and 9 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -122.4269 ymin: 37.74783 xmax: -122.403 ymax: 37.77565
## Geodetic CRS:  WGS 84
##     nhood  pwhite   pblack   pasian    phisp pwhite17 pblack17 pasian17
## 1 Mission 32.5255 2.973325 11.01126 50.07308 41.09069 3.660031 14.46827
##    phisp17                       geometry
## 1 35.66786 MULTIPOLYGON (((-122.411 37...</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="emplacing-demographic-data.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the share of white population of &quot;Mission&quot;</span></span>
<span id="cb17-2"><a href="emplacing-demographic-data.html#cb17-2" aria-hidden="true" tabindex="-1"></a>sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="emplacing-demographic-data.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhood <span class="sc">==</span> <span class="st">&quot;Mission&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="emplacing-demographic-data.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pwhite)</span></code></pre></div>
<pre><code>## Simple feature collection with 1 feature and 1 field
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -122.4269 ymin: 37.74783 xmax: -122.403 ymax: 37.77565
## Geodetic CRS:  WGS 84
##    pwhite                       geometry
## 1 32.5255 MULTIPOLYGON (((-122.411 37...</code></pre>
<p>In maps, we can highlight specific neighborhoods by creating conditions.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="emplacing-demographic-data.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create conditions for highlights</span></span>
<span id="cb19-2"><a href="emplacing-demographic-data.html#cb19-2" aria-hidden="true" tabindex="-1"></a>sf_joined <span class="ot">&lt;-</span> sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="emplacing-demographic-data.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-4"><a href="emplacing-demographic-data.html#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlight_mission =</span> <span class="fu">ifelse</span>(nhood <span class="sc">==</span> <span class="st">&quot;Mission&quot;</span>, <span class="st">&quot;Highlighted&quot;</span>, <span class="st">&quot;Other&quot;</span>), <span class="co"># highlight the Mission</span></span>
<span id="cb19-5"><a href="emplacing-demographic-data.html#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlight_white =</span> <span class="fu">ifelse</span>(pwhite <span class="sc">&gt;</span> <span class="dv">70</span>, <span class="st">&quot;Highlighted&quot;</span>, <span class="st">&quot;Other&quot;</span>)           <span class="co"># highlight white neighborhoods</span></span>
<span id="cb19-6"><a href="emplacing-demographic-data.html#cb19-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-7"><a href="emplacing-demographic-data.html#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="emplacing-demographic-data.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create highlighted maps</span></span>
<span id="cb19-9"><a href="emplacing-demographic-data.html#cb19-9" aria-hidden="true" tabindex="-1"></a>mission_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> sf_joined) <span class="sc">+</span></span>
<span id="cb19-10"><a href="emplacing-demographic-data.html#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> highlight_mission), <span class="co"># specify a variable to fill</span></span>
<span id="cb19-11"><a href="emplacing-demographic-data.html#cb19-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb19-12"><a href="emplacing-demographic-data.html#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Highlighted&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Other&quot;</span> <span class="ot">=</span> <span class="st">&quot;light grey&quot;</span>)) <span class="sc">+</span> <span class="co"># specify colors to fill</span></span>
<span id="cb19-13"><a href="emplacing-demographic-data.html#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-14"><a href="emplacing-demographic-data.html#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb19-15"><a href="emplacing-demographic-data.html#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co"># remove legend</span></span>
<span id="cb19-16"><a href="emplacing-demographic-data.html#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="emplacing-demographic-data.html#cb19-17" aria-hidden="true" tabindex="-1"></a>white_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> sf_joined) <span class="sc">+</span></span>
<span id="cb19-18"><a href="emplacing-demographic-data.html#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> highlight_white), </span>
<span id="cb19-19"><a href="emplacing-demographic-data.html#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb19-20"><a href="emplacing-demographic-data.html#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Highlighted&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Other&quot;</span> <span class="ot">=</span> <span class="st">&quot;light grey&quot;</span>)) <span class="sc">+</span></span>
<span id="cb19-21"><a href="emplacing-demographic-data.html#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-22"><a href="emplacing-demographic-data.html#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb19-23"><a href="emplacing-demographic-data.html#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)  </span>
<span id="cb19-24"><a href="emplacing-demographic-data.html#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="emplacing-demographic-data.html#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Combining maps</span></span>
<span id="cb19-26"><a href="emplacing-demographic-data.html#cb19-26" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(mission_map, white_map, <span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb19-27"><a href="emplacing-demographic-data.html#cb19-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;The Mission&quot;</span>,</span>
<span id="cb19-28"><a href="emplacing-demographic-data.html#cb19-28" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;White Neighborhoods&quot;</span>)</span>
<span id="cb19-29"><a href="emplacing-demographic-data.html#cb19-29" aria-hidden="true" tabindex="-1"></a>                  ) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/highlgiht-neighborhood-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="emplacing-demographic-data.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export your joined sf object as a geojson file</span></span>
<span id="cb20-2"><a href="emplacing-demographic-data.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(sf_joined, <span class="st">&quot;processed-data/sfnh_dem_joined.geojson&quot;</span>, </span>
<span id="cb20-3"><a href="emplacing-demographic-data.html#cb20-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">&quot;GeoJSON&quot;</span>,</span>
<span id="cb20-4"><a href="emplacing-demographic-data.html#cb20-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">delete_dsn =</span> <span class="cn">TRUE</span> <span class="co"># overwrite the existing file</span></span>
<span id="cb20-5"><a href="emplacing-demographic-data.html#cb20-5" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
<pre><code>## Deleting source `processed-data/sfnh_dem_joined.geojson&#39; using driver `GeoJSON&#39;
## Writing layer `sfnh_dem_joined&#39; to data source 
##   `processed-data/sfnh_dem_joined.geojson&#39; using driver `GeoJSON&#39;
## Writing 41 features with 11 fields and geometry type Multi Polygon.</code></pre>
<p><strong>THINK AND SHARE</strong></p>
<p>Below, you see two maps, each representing Chicago ans Seattle.</p>
<div class="figure">
<img src="images/map-example.png" alt="" />
<p class="caption">Source: Hwang (2015).doi: 10.1177/0002716215579823</p>
</div>
<ul>
<li>What are the geographic boundaries used in this figure?</li>
<li>What attribute is displayed in the map?</li>
<li>Is this attribute quantitative or qualitative?</li>
</ul>
<p>Compare this map to the other map of Chicago below:</p>
<div class="figure">
<img src="images/map-example2.png" alt="" />
<p class="caption">Source: Bader (2011). doi: 10.1111/j.1540-6040.2011.01368.x</p>
</div>
<p>Explore <a href="https://opendata.paris.fr/pages/home/">Open Data website for City of Paris</a>.</p>
<ul>
<li>Can you find boundaries data?</li>
<li>What kind of data do you find interesting? Demographic? Cultural?</li>
<li>What potential research questions could you ask?</li>
</ul>

</div>
<div id="data-visualization" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Data visualization<a href="emplacing-demographic-data.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By joining attributes with spatial boundaries, now we can map demographic patterns. But, first of all, what is a map? A map is a simplified and codified image of geographical space, representing its characteristics and/or its organization. It is the result of a creative action and of the choices made by its author (Lambert and Zanin, 2000; p.4).</p>
<div class="figure">
<img src="images/map-concept.png" alt="" />
<p class="caption">Source: Lambert and Zanin (2020)</p>
</div>
<p>Lambert and Zanin (2020) classify maps into two types: Topographic maps are maps that mainly show results of direct observation, such as water courses and human constructions. These maps represent concrete elements that are durably established on a portion of terrestrial space at a given time.</p>
<p>Thematic maps are maps on which localizable qualitative or quantitative phenomena of all kinds are represented. Information is represented according to the rules of graphic semiology. These maps are designed, laid out, and “staged” to produce an intelligible image of the geographical phenomenon at hand.</p>
<p>We will learn how to create <strong>thematic maps</strong>.</p>
<div class="figure">
<img src="images/thematic_map.png" alt="" />
<p class="caption">Source: Lambert and Zanin (2020)</p>
</div>
<p>When it comes to making thematic maps, it is important to consider what type of variable you intend to display (think of your attribute data). We will learn about two different types of maps: <strong>Choropleth map</strong> for quantitative variables and <strong>Typology map</strong> for qualitative variables.</p>
<div id="choropleth-map" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Choropleth map<a href="emplacing-demographic-data.html#choropleth-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A choropleth map is useful for visualizing quantitative variables. This type of map displays color corresponding with an aggregated variable for a given geographic unit, such as population density or per-capital income.</p>
<p><strong>EXAMPLE: MEASURING AND MAPPING DIVERSITY</strong></p>
<p>In social science research, scholars often use the Herfindahl-Hirschman Index (HHI) as a measure for diversity. It is an economic index, but the formula is also used in ecology (called the Simpson diversity index), as well as in demographic contexts. The formula is:</p>
<p><span class="math display">\[
HHI = \sum_{i=1}^{N} (MS_i)^2
\]</span>
Where <span class="math inline">\(MS_i\)</span> is the market share of firm <span class="math inline">\(i\)</span> in the market, and <span class="math inline">\(N\)</span> is the number of firms. The lower the HHI, the more competition in the market (many firms with relatively equal market shares). Reversely, the higher the HHI, the less competition in the market, suggesting monopoly.</p>
<p>In demographic research, sociologists commonly use the HHI to measure racial diversity of neighborhoods. Instead of market shares of firms in a market, we use the shares of racial groups in a neighborhood.</p>
<p>For example, in a neighborhood with 4 racial groups each representing 25%, the HHI would be:</p>
<p><span class="math display">\[
0.25^2 + 0.25^2 + 0.25^2 + 0.25^2 = 0.25
\]</span></p>
<p>Compared this to another neighborhood with 2 racial groups – one representing 80% and the other representing 20%. The HHI would be:</p>
<p><span class="math display">\[
0.80^2 + 0.20^2 = 0.68
\]</span></p>
<p>The first neighborhood with the HHI of 25% is more diverse compared to the second neighborhood with the HHI of 68%.</p>
<p>We can create this diversity measure using the variables we have.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="emplacing-demographic-data.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the HHI </span></span>
<span id="cb22-2"><a href="emplacing-demographic-data.html#cb22-2" aria-hidden="true" tabindex="-1"></a>sf_joined <span class="ot">&lt;-</span> sf_joined <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="emplacing-demographic-data.html#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diversity =</span> (pwhite<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> pblack<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> phisp<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> pasian<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb22-4"><a href="emplacing-demographic-data.html#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="emplacing-demographic-data.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check</span></span>
<span id="cb22-6"><a href="emplacing-demographic-data.html#cb22-6" aria-hidden="true" tabindex="-1"></a>sf_joined <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="emplacing-demographic-data.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(diversity)</span></code></pre></div>
<pre><code>## Simple feature collection with 41 features and 1 field
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -122.5149 ymin: 37.70813 xmax: -122.357 ymax: 37.8333
## Geodetic CRS:  WGS 84
## First 10 features:
##    diversity                       geometry
## 1   30.41952 MULTIPOLYGON (((-122.3816 3...
## 2   29.24377 MULTIPOLYGON (((-122.4036 3...
## 3   60.80993 MULTIPOLYGON (((-122.4263 3...
## 4   72.94796 MULTIPOLYGON (((-122.4067 3...
## 5   33.48204 MULTIPOLYGON (((-122.4246 3...
## 6   42.47888 MULTIPOLYGON (((-122.3875 3...
## 7   41.08415 MULTIPOLYGON (((-122.4474 3...
## 8   48.51617 MULTIPOLYGON (((-122.4426 3...
## 9   57.51691 MULTIPOLYGON (((-122.4321 3...
## 10  39.00489 MULTIPOLYGON (((-122.4207 3...</code></pre>
<p>To create a choropleth map, we first have to check the statistical distribution of the variable.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="emplacing-demographic-data.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sf_joined<span class="sc">$</span>diversity)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/histogram-1.png" width="672" /></p>
<p>There are various methods to determine how you classify colors. The most common methods are quantile binning, natural breaks (jenks), standard deviation, and custom breaks (defined by the researcher). Below, I use the quantile binning and create a map displaying how diverse/homogeneous San Francisco neighborhoods are.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="emplacing-demographic-data.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a choropleth map visualizing the diversity variable</span></span>
<span id="cb25-2"><a href="emplacing-demographic-data.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb25-3"><a href="emplacing-demographic-data.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_joined,                <span class="co"># specify the source of spatial data</span></span>
<span id="cb25-4"><a href="emplacing-demographic-data.html#cb25-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> diversity),           <span class="co"># add a layer to use &quot;diversity&quot; to fill colors</span></span>
<span id="cb25-5"><a href="emplacing-demographic-data.html#cb25-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb25-6"><a href="emplacing-demographic-data.html#cb25-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-7"><a href="emplacing-demographic-data.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">type=</span><span class="st">&quot;seq&quot;</span>,         <span class="co"># fill in sequential colors </span></span>
<span id="cb25-8"><a href="emplacing-demographic-data.html#cb25-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>,</span>
<span id="cb25-9"><a href="emplacing-demographic-data.html#cb25-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">quantile</span>(sf_joined<span class="sc">$</span>diversity),</span>
<span id="cb25-10"><a href="emplacing-demographic-data.html#cb25-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,     <span class="co"># 1 for low (light) to high (dark), -1 for reverse</span></span>
<span id="cb25-11"><a href="emplacing-demographic-data.html#cb25-11" aria-hidden="true" tabindex="-1"></a>                       ) <span class="sc">+</span></span>
<span id="cb25-12"><a href="emplacing-demographic-data.html#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb25-13"><a href="emplacing-demographic-data.html#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;HHI&quot;</span>, <span class="co"># add a label for legend</span></span>
<span id="cb25-14"><a href="emplacing-demographic-data.html#cb25-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Racial Diversity in San Francisco&quot;</span> <span class="co"># figure title</span></span>
<span id="cb25-15"><a href="emplacing-demographic-data.html#cb25-15" aria-hidden="true" tabindex="-1"></a>       ) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/choro-map-1.png" width="672" /></p>
<ul>
<li>What are the least diverse neighborhoods?</li>
<li>What are the most diverse neighborhoods?</li>
</ul>
<p>For those who are not familair with San Francisco neighborhoods, we can add labels displaying neighborhood names corresponding to neighborhood boundaries.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="emplacing-demographic-data.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels to the map</span></span>
<span id="cb26-2"><a href="emplacing-demographic-data.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb26-3"><a href="emplacing-demographic-data.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_joined, </span>
<span id="cb26-4"><a href="emplacing-demographic-data.html#cb26-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">fill =</span> diversity),  </span>
<span id="cb26-5"><a href="emplacing-demographic-data.html#cb26-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb26-6"><a href="emplacing-demographic-data.html#cb26-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-7"><a href="emplacing-demographic-data.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">type=</span><span class="st">&quot;seq&quot;</span>,</span>
<span id="cb26-8"><a href="emplacing-demographic-data.html#cb26-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>,</span>
<span id="cb26-9"><a href="emplacing-demographic-data.html#cb26-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">quantile</span>(sf_joined<span class="sc">$</span>diversity),</span>
<span id="cb26-10"><a href="emplacing-demographic-data.html#cb26-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb26-11"><a href="emplacing-demographic-data.html#cb26-11" aria-hidden="true" tabindex="-1"></a>                       ) <span class="sc">+</span></span>
<span id="cb26-12"><a href="emplacing-demographic-data.html#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_label</span>(<span class="at">data =</span> sf_joined,</span>
<span id="cb26-13"><a href="emplacing-demographic-data.html#cb26-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">label =</span> nhood),         <span class="co"># add a layer of labels using the nhood variable</span></span>
<span id="cb26-14"><a href="emplacing-demographic-data.html#cb26-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">1.5</span>,                <span class="co"># size of the label text</span></span>
<span id="cb26-15"><a href="emplacing-demographic-data.html#cb26-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,           <span class="co"># color of the text</span></span>
<span id="cb26-16"><a href="emplacing-demographic-data.html#cb26-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,            <span class="co"># background fill color</span></span>
<span id="cb26-17"><a href="emplacing-demographic-data.html#cb26-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.padding =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">&quot;lines&quot;</span>),  <span class="co"># padding around the text</span></span>
<span id="cb26-18"><a href="emplacing-demographic-data.html#cb26-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label.size =</span> <span class="dv">0</span>,            <span class="co"># thickness of the border around the label</span></span>
<span id="cb26-19"><a href="emplacing-demographic-data.html#cb26-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.5</span>,               <span class="co"># set transparency of the background</span></span>
<span id="cb26-20"><a href="emplacing-demographic-data.html#cb26-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span>    <span class="co"># suppress overlapping texts</span></span>
<span id="cb26-21"><a href="emplacing-demographic-data.html#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb26-22"><a href="emplacing-demographic-data.html#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;HHI&quot;</span>, <span class="co"># add a label for legend</span></span>
<span id="cb26-23"><a href="emplacing-demographic-data.html#cb26-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Racial Diversity in San Francisco&quot;</span> <span class="co"># figure title</span></span>
<span id="cb26-24"><a href="emplacing-demographic-data.html#cb26-24" aria-hidden="true" tabindex="-1"></a>       ) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/add-labels-1.png" width="672" /></p>
</div>
<div id="typology-map" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Typology map<a href="emplacing-demographic-data.html#typology-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A typology map is suitable for qualitative variables that consist distinct and meaningful categories. We will create a gentrification measure to demonstrate a use case for typology map. Gentrification is a phenomenon that we measure over space and time. While there are multiple ways to define and measure gentrification, for the purposes of this tutorial, we will conceptualize gentrification as a neighborhood-level socioeconomic transformation comprised of both an influx of middle-and upper-class residents and an increase in housing prices in previously low-income, urban neighborhoods.</p>
<p>Our measure of gentrification is calculated at the census tract level from 2000 to 2020, so that we can examine how the socioeconomic composition of neighborhoods in San Francisco changes over time. The four variables listed below are used in our categorical measure of gentrification:</p>
<ul>
<li>Median household income (in 2020 Dollars)</li>
<li>Percent of college-educated residents</li>
<li>Median home value (in 2020 Dollars)</li>
<li>Median gross rent (in 2020 Dollars)</li>
</ul>
<p>The first step in computing the gentrification measure is determining whether or not a tract is <strong>eligible to gentrify (i.e., Gentrifiable).</strong> Generally, researchers consider tracts eligible to gentrify if they are relatively low-income neighborhoods such that they could undergo the revitalization that characterizes gentrification. We will operationalize eligibility to gentrify in a binary fashion using the median household income.</p>
<blockquote>
<p><strong>Not Gentrifiable</strong>: Census tracts had a median household income <em>above</em> the city-wide median household income at the start of the period.</p>
</blockquote>
<blockquote>
<p><strong>Gentrifiable</strong>: Census tracts had a median household income <em>below</em> the city-wide median household income at the start of the period.</p>
</blockquote>
<p>Next, among the census tracts that were Gentrifiable, we must determine if they were gentrifying over time or not. To classify the gentrifiable tracts as gentrifying or not gentrifying, we will need to calculate how much socioeconomic change and housing value change the tract experienced over the decade and compare the rate of change to the rate in the city.</p>
<blockquote>
<p><strong>Gentrifying</strong>: Gentrifiable census tracts that had the socioeconomic status of their residents (i.e., % college graduates OR median household income) grow faster than the city wide-median <em>AND</em> the home values (median home value OR median gross rent value) grow faster than the city-wide median over the decade period.</p>
</blockquote>
<blockquote>
<p><strong>Not Gentrifying</strong>: Gentrifiable census tracts that did NOT experience growth in the socioeconomic status of their residents <em>AND</em> their home values at a rate higher than the city-wide median values over the decade period.</p>
</blockquote>
<p>This measurement strategy results in a three-category gentrification measure - Not Gentrifiable, Gentrifying, and Not Gentrifying. With these three categories we can make a typology map of census tracts in San Francisco.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="emplacing-demographic-data.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import demographic attributes for census tracts</span></span>
<span id="cb27-2"><a href="emplacing-demographic-data.html#cb27-2" aria-hidden="true" tabindex="-1"></a>sftrt_dem <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/sftrt_dem.csv&quot;</span>)</span>
<span id="cb27-3"><a href="emplacing-demographic-data.html#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="emplacing-demographic-data.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore the data</span></span>
<span id="cb27-5"><a href="emplacing-demographic-data.html#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sftrt_dem, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##   trt10 tpop pyoung  pcol      minc     mhval    mrent  pwht pblk pasian phisp
## 1 10100 2879  36.99 55.63  76037.34  801814.8 1544.629 57.55 5.52  26.02  7.26
## 2 10200 4288  36.92 70.51 122888.48 1206373.1 1808.258 83.65 0.72   9.82  3.78
## 3 10300 4092  30.99 59.79 100281.00  927944.9 1671.979 58.04 0.56  35.04  3.42
## 4 10400 4859  32.62 61.38 108566.69 1057897.0 1645.376 62.85 0.62  31.34  3.42
## 5 10500 2217  16.78 68.54 113515.23  791430.7 2258.772 75.33 1.89  17.14  3.20
##   tpop17 pyoung17 pcol17 minc17 mhval17 mrent17 pwht17 pblk17 pasian17 phisp17
## 1   3889    34.89  52.96  62414 1145800    1770  39.01   6.07    39.44   12.21
## 2   4167    33.79  85.81 151453 1305300    2471  80.71   2.02    12.07    3.26
## 3   4359    37.49  72.79 150972 1545800    2206  59.44   0.00    29.04    9.34
## 4   4536    30.69  74.11 130732 1519800    2220  62.94   0.20    22.57    7.58
## 5   2779    24.72  78.56 135300 1525000    2270  49.80   9.07    23.68    7.56
##            gentcat
## 1  non-gentrifying
## 2 non-gentrifiable
## 3 non-gentrifiable
## 4 non-gentrifiable
## 5 non-gentrifiable</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="emplacing-demographic-data.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore the geometry</span></span>
<span id="cb29-2"><a href="emplacing-demographic-data.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sftrt, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 5 features and 2 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -122.4438 ymin: 37.77271 xmax: -122.4234 ymax: 37.7887
## Geodetic CRS:  WGS 84
##              nhood tractce10                       geometry
## 1     Hayes Valley    016400 MULTIPOLYGON (((-122.4325 3...
## 2 Western Addition    016100 MULTIPOLYGON (((-122.4235 3...
## 3 Western Addition    015900 MULTIPOLYGON (((-122.4247 3...
## 4        Japantown    015500 MULTIPOLYGON (((-122.4247 3...
## 5  Pacific Heights    015300 MULTIPOLYGON (((-122.4349 3...</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="emplacing-demographic-data.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if it has a common identifier with sftrt</span></span>
<span id="cb31-2"><a href="emplacing-demographic-data.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sftrt_dem<span class="sc">$</span>trt10)</span></code></pre></div>
<pre><code>## [1] 10100 10200 10300 10400 10500 10600</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="emplacing-demographic-data.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(sftrt_dem<span class="sc">$</span>trt10)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="emplacing-demographic-data.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sftrt<span class="sc">$</span>tractce10)</span></code></pre></div>
<pre><code>## [1] &quot;016400&quot; &quot;016100&quot; &quot;015900&quot; &quot;015500&quot; &quot;015300&quot; &quot;015100&quot;</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="emplacing-demographic-data.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(sftrt<span class="sc">$</span>tractce10)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="emplacing-demographic-data.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill with leading zeros and convert to string</span></span>
<span id="cb39-2"><a href="emplacing-demographic-data.html#cb39-2" aria-hidden="true" tabindex="-1"></a>sftrt_dem <span class="ot">&lt;-</span> sftrt_dem <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="emplacing-demographic-data.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tractce10 =</span> <span class="fu">as.character</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%06d&quot;</span>, trt10)))</span>
<span id="cb39-4"><a href="emplacing-demographic-data.html#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="emplacing-demographic-data.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Join demographic data with geometric boundaries</span></span>
<span id="cb39-6"><a href="emplacing-demographic-data.html#cb39-6" aria-hidden="true" tabindex="-1"></a>sftrt_joined <span class="ot">&lt;-</span> <span class="fu">merge</span>(</span>
<span id="cb39-7"><a href="emplacing-demographic-data.html#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> sftrt,               <span class="co"># sf object</span></span>
<span id="cb39-8"><a href="emplacing-demographic-data.html#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> sftrt_dem,           <span class="co"># data frame</span></span>
<span id="cb39-9"><a href="emplacing-demographic-data.html#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">by.x =</span> <span class="st">&quot;tractce10&quot;</span>,      <span class="co"># x identifier</span></span>
<span id="cb39-10"><a href="emplacing-demographic-data.html#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">by.y =</span> <span class="st">&quot;tractce10&quot;</span>,      <span class="co"># y identifier</span></span>
<span id="cb39-11"><a href="emplacing-demographic-data.html#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,            <span class="co"># keep all lines</span></span>
<span id="cb39-12"><a href="emplacing-demographic-data.html#cb39-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-13"><a href="emplacing-demographic-data.html#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="emplacing-demographic-data.html#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Export your joined sf object as a geojson file</span></span>
<span id="cb39-15"><a href="emplacing-demographic-data.html#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(sftrt_joined, <span class="st">&quot;processed-data/sftrt_dem_joined.geojson&quot;</span>, </span>
<span id="cb39-16"><a href="emplacing-demographic-data.html#cb39-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">&quot;GeoJSON&quot;</span>,</span>
<span id="cb39-17"><a href="emplacing-demographic-data.html#cb39-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">delete_dsn =</span> <span class="cn">TRUE</span> <span class="co"># overwrite the existing file</span></span>
<span id="cb39-18"><a href="emplacing-demographic-data.html#cb39-18" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
<pre><code>## Deleting source `processed-data/sftrt_dem_joined.geojson&#39; using driver `GeoJSON&#39;
## Writing layer `sftrt_dem_joined&#39; to data source 
##   `processed-data/sftrt_dem_joined.geojson&#39; using driver `GeoJSON&#39;
## Writing 195 features with 24 fields and geometry type Multi Polygon.</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="emplacing-demographic-data.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check your variable of interest</span></span>
<span id="cb41-2"><a href="emplacing-demographic-data.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(sftrt_joined<span class="sc">$</span>gentcat))</span></code></pre></div>
<pre><code>## [1] &quot;non-gentrifying&quot;  &quot;non-gentrifiable&quot; &quot;gentrifying&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="emplacing-demographic-data.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a typology map</span></span>
<span id="cb43-2"><a href="emplacing-demographic-data.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sftrt_joined) <span class="sc">+</span> </span>
<span id="cb43-3"><a href="emplacing-demographic-data.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> gentcat), </span>
<span id="cb43-4"><a href="emplacing-demographic-data.html#cb43-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.02</span>,</span>
<span id="cb43-5"><a href="emplacing-demographic-data.html#cb43-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="emplacing-demographic-data.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;non-gentrifiable&quot;</span> <span class="ot">=</span> <span class="st">&quot;light grey&quot;</span>, </span>
<span id="cb43-7"><a href="emplacing-demographic-data.html#cb43-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;gentrifying&quot;</span> <span class="ot">=</span> <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb43-8"><a href="emplacing-demographic-data.html#cb43-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&quot;non-gentrifying&quot;</span> <span class="ot">=</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span>    <span class="co"># specify colors corresponding to each category</span></span>
<span id="cb43-9"><a href="emplacing-demographic-data.html#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb43-10"><a href="emplacing-demographic-data.html#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Gentrification Category&quot;</span>, </span>
<span id="cb43-11"><a href="emplacing-demographic-data.html#cb43-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Gentrification in San Francisco&quot;</span></span>
<span id="cb43-12"><a href="emplacing-demographic-data.html#cb43-12" aria-hidden="true" tabindex="-1"></a>       )</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/typo-map-1.png" width="672" /></p>
<p><strong>CODING EXERCISE</strong></p>
<ul>
<li>Create a qualitative variable with three categories: high-income, middle-income, and low-income.</li>
<li>Create a typology map using this variable (“nh-ses”).</li>
</ul>
<p><strong>LEARN MORE</strong></p>
<p>For more detailed guidance as to how to choose a discretization method for choropleth map, you can see <a href="https://magrit-formations.github.io/discretisation/#/title-slide">the slides</a> made by Nicholas Lambert and his colleagues.</p>
<p>Steele and her colleagues (2022) published a <a href="https://www.annualreviews.org/content/journals/10.1146/annurev-soc-030420-015435">review article</a>, summerizing existing quantitative approaches to measuring ethnic diversity. HHI (also referred to as ELF) is included as one of the most common measurements.</p>
<p>Brown-Saracino (2017) reviews the concept and measurement of gentrification in contemporary literature in a <a href="https://www.annualreviews.org/content/journals/10.1146/annurev-soc-060116-053427">review article</a>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="from-people-to-built-environment.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hyoon28/soc-gis-tutorial/edit/main/02-dem-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/hyoon28/soc-gis-tutorial/blob/main/02-dem-data.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
