<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 From People to Built Environment | Spatial Data and Mapping for Sociologists</title>
  <meta name="description" content="This is a website with tutorials for Advanced Quantitative Methods in Contemporary Sociology’s Spatial Data and Mapping module." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 From People to Built Environment | Spatial Data and Mapping for Sociologists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a website with tutorials for Advanced Quantitative Methods in Contemporary Sociology’s Spatial Data and Mapping module." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 From People to Built Environment | Spatial Data and Mapping for Sociologists" />
  
  <meta name="twitter:description" content="This is a website with tutorials for Advanced Quantitative Methods in Contemporary Sociology’s Spatial Data and Mapping module." />
  

<meta name="author" content="Hesu Yoon" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="emplacing-demographic-data.html"/>
<link rel="next" href="additional-topics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SOC-GIS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#table-of-contents"><i class="fa fa-check"></i><b>1.1</b> Table of Contents</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html"><i class="fa fa-check"></i><b>2</b> Emplacing Demographic Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#defining-boundaries"><i class="fa fa-check"></i><b>2.1</b> Defining boundaries</a></li>
<li class="chapter" data-level="2.2" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#joining-attributes"><i class="fa fa-check"></i><b>2.2</b> Joining attributes</a></li>
<li class="chapter" data-level="2.3" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#data-visualization"><i class="fa fa-check"></i><b>2.3</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#choropleth-map"><i class="fa fa-check"></i><b>2.3.1</b> Choropleth map</a></li>
<li class="chapter" data-level="2.3.2" data-path="emplacing-demographic-data.html"><a href="emplacing-demographic-data.html#typology-map"><i class="fa fa-check"></i><b>2.3.2</b> Typology map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html"><i class="fa fa-check"></i><b>3</b> From People to Built Environment</a>
<ul>
<li class="chapter" data-level="3.1" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#transforming-airbnbs"><i class="fa fa-check"></i><b>3.1</b> Transforming Airbnbs</a></li>
<li class="chapter" data-level="3.2" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#geocoding-restaurants"><i class="fa fa-check"></i><b>3.2</b> Geocoding Restaurants</a></li>
<li class="chapter" data-level="3.3" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#spatial-join"><i class="fa fa-check"></i><b>3.3</b> Spatial join</a></li>
<li class="chapter" data-level="3.4" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#data-visualization-1"><i class="fa fa-check"></i><b>3.4</b> Data visualization</a></li>
<li class="chapter" data-level="3.5" data-path="from-people-to-built-environment.html"><a href="from-people-to-built-environment.html#export-maps"><i class="fa fa-check"></i><b>3.5</b> Export Maps</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="additional-topics.html"><a href="additional-topics.html"><i class="fa fa-check"></i><b>4</b> Additional Topics</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Data and Mapping for Sociologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="from-people-to-built-environment" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> From People to Built Environment<a href="from-people-to-built-environment.html#from-people-to-built-environment" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>So far, we have focused on embedding demographic data into places. However, sociological questions beyond people. People don’t just exist in places but they interact with the built environment, such as schools, local businesses, landmarks, and so forth. In GIS terms, this type of data can be called point-of-interest (POI), meaning a specific point location or useful site, defined by geographical coordinates (latitude and longitude). In this tutorial, we will use Airbnb and local business data as an example of point-of-interest data.</p>
<div id="transforming-airbnbs" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Transforming Airbnbs<a href="from-people-to-built-environment.html#transforming-airbnbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When the data contains the latitude and longitude, we can simply transform it to sf object by using “st_as_sf” command. We will use the San Francisco Airbnb data to illustrate this case. Unlike neighborhood boundaries of which geometries were polygons, these geometries will be <strong>points</strong>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="from-people-to-built-environment.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the Airbnb data</span></span>
<span id="cb33-2"><a href="from-people-to-built-environment.html#cb33-2" aria-hidden="true" tabindex="-1"></a>sfbnb <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/sfbnb.csv&quot;</span>)</span>
<span id="cb33-3"><a href="from-people-to-built-environment.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="from-people-to-built-environment.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform lat/long data into sf object</span></span>
<span id="cb33-5"><a href="from-people-to-built-environment.html#cb33-5" aria-hidden="true" tabindex="-1"></a>sf_sfbnb <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(sfbnb, </span>
<span id="cb33-6"><a href="from-people-to-built-environment.html#cb33-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitude&quot;</span>, <span class="st">&quot;latitude&quot;</span>), </span>
<span id="cb33-7"><a href="from-people-to-built-environment.html#cb33-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">crs =</span> <span class="dv">4326</span> <span class="co"># specify the projection; WGS84 is a standard projection for global mapping. </span></span>
<span id="cb33-8"><a href="from-people-to-built-environment.html#cb33-8" aria-hidden="true" tabindex="-1"></a>                     )</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="from-people-to-built-environment.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check variables</span></span>
<span id="cb34-2"><a href="from-people-to-built-environment.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sf_sfbnb, <span class="at">n=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 3 features and 7 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -122.4525 ymin: 37.74511 xmax: -122.421 ymax: 37.76931
## Geodetic CRS:  WGS 84
##     id trt10       analysis property_type review_scores_rating
## 1  958 16700 haight ashbury     Apartment                   97
## 2 5858 25300 bernal heights     Apartment                   98
## 3 7918 17102 haight ashbury     Apartment                   85
##   review_scores_location number_of_reviews                   geometry
## 1                     10               176 POINT (-122.4339 37.76931)
## 2                     10               111  POINT (-122.421 37.74511)
## 3                      9                17 POINT (-122.4525 37.76669)</code></pre>
<p>You can see that geometry is points, rather than polygons. Each point represents an Airbnb property (id- unique identifier). It also indicates the census tract (trt10) and neighborhood name (analysis) in which the Airbnb property is located. The data also contains attributes of the Airbnb property, such as property type, review score ratings, and the number of reviews.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="from-people-to-built-environment.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export the Airbnb data as a geojson file</span></span>
<span id="cb36-2"><a href="from-people-to-built-environment.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(sf_sfbnb, <span class="st">&quot;processed-data/airbnbs.geojson&quot;</span>, <span class="at">driver =</span> <span class="st">&quot;GeoJSON&quot;</span>, <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="geocoding-restaurants" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Geocoding Restaurants<a href="from-people-to-built-environment.html#geocoding-restaurants" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes, your data may not have the latitude and longitude information. Instead, the data may contain street addresses. In such a case, we have to perform <strong>geocoding</strong> which converts formatted addresses into latitude and longitude. Below, we use the restaurant data in San Francisco to demonstrate the geocoding process.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="from-people-to-built-environment.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import restaurant data</span></span>
<span id="cb37-2"><a href="from-people-to-built-environment.html#cb37-2" aria-hidden="true" tabindex="-1"></a>sfbiz <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/sfbiz_clean.csv&quot;</span>) </span>
<span id="cb37-3"><a href="from-people-to-built-environment.html#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="from-people-to-built-environment.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if lat and lon exists</span></span>
<span id="cb37-5"><a href="from-people-to-built-environment.html#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sfbiz, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                         company address_line_1          city zipcode
## 1                  JOHN&#39;S GRILL    63 ELLIS ST SAN FRANCISCO   94102
## 2              TAD&#39;S STEAKHOUSE  120 POWELL ST SAN FRANCISCO   94102
## 3 SAM&#39;S GRILL &amp; SEA FOOD RSTRNT    374 BUSH ST SAN FRANCISCO   94104
##        naics8_descriptions employee_size_location sales_volume_location state
## 1 FULL-SERVICE RESTAURANTS                     20                  1424    CA
## 2 FULL-SERVICE RESTAURANTS                     19                  1353    CA
## 3 FULL-SERVICE RESTAURANTS                     35                  2491    CA</code></pre>
<p>In this data, we can see that latitude and longitude does not exist. However, it contains street address, city, state, and zip code. To carry out geocoding, first, we have to create a field that displays a full address. Based on the full address, we can get the latitude and longitude via open street map (osm). Once the data is geocoded, we can transform this data frame to sf object for mapping.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="from-people-to-built-environment.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up</span></span>
<span id="cb39-2"><a href="from-people-to-built-environment.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygeocoder)</span>
<span id="cb39-3"><a href="from-people-to-built-environment.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="from-people-to-built-environment.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a full address field (street address, city, state, zipcode)</span></span>
<span id="cb39-5"><a href="from-people-to-built-environment.html#cb39-5" aria-hidden="true" tabindex="-1"></a>sfbiz <span class="ot">&lt;-</span> sfbiz <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="from-people-to-built-environment.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">full_add =</span> <span class="fu">paste</span>(address_line_1, city, state, zipcode, <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>))</span>
<span id="cb39-7"><a href="from-people-to-built-environment.html#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="from-people-to-built-environment.html#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Geocode the full address</span></span>
<span id="cb39-9"><a href="from-people-to-built-environment.html#cb39-9" aria-hidden="true" tabindex="-1"></a>geocoded_sfbiz <span class="ot">&lt;-</span> sfbiz <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="from-people-to-built-environment.html#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="co"># the full data can take a while, so let&#39;s try on a smaller sample</span></span>
<span id="cb39-11"><a href="from-people-to-built-environment.html#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geocode</span>(<span class="at">address =</span> full_add, <span class="at">method =</span> <span class="st">&#39;osm&#39;</span>)</span>
<span id="cb39-12"><a href="from-people-to-built-environment.html#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="from-people-to-built-environment.html#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the geocoded data</span></span>
<span id="cb39-14"><a href="from-people-to-built-environment.html#cb39-14" aria-hidden="true" tabindex="-1"></a>geocoded_sfbiz <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="from-people-to-built-environment.html#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lat, long)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##     lat  long
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  37.8 -122.
## 2  37.8 -122.
## 3  37.8 -122.
## 4  37.8 -122.
## 5  37.8 -122.</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="from-people-to-built-environment.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the purpose of this tutorial, we can use the prepared, full geocoded data</span></span>
<span id="cb41-2"><a href="from-people-to-built-environment.html#cb41-2" aria-hidden="true" tabindex="-1"></a>prep_sfbiz <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/geocoded_sfbiz_clean.csv&quot;</span>) </span>
<span id="cb41-3"><a href="from-people-to-built-environment.html#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="from-people-to-built-environment.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform lat/long data into sf oject</span></span>
<span id="cb41-5"><a href="from-people-to-built-environment.html#cb41-5" aria-hidden="true" tabindex="-1"></a>sf_sfbiz <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(prep_sfbiz, </span>
<span id="cb41-6"><a href="from-people-to-built-environment.html#cb41-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;long&quot;</span>, <span class="st">&quot;lat&quot;</span>), </span>
<span id="cb41-7"><a href="from-people-to-built-environment.html#cb41-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">crs =</span> <span class="dv">4326</span>)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="from-people-to-built-environment.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export the restaurant data as a geojson file</span></span>
<span id="cb42-2"><a href="from-people-to-built-environment.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(sf_sfbiz, <span class="st">&quot;processed-data/restaurants.geojson&quot;</span>, <span class="at">driver =</span> <span class="st">&quot;GeoJSON&quot;</span>, <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span></code></pre></div>

</div>
<div id="spatial-join" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Spatial join<a href="from-people-to-built-environment.html#spatial-join" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spatial join allows you to combine two sf objects based on the spatial relationship between their geometries. For example, we can think of the relationship between neighborhoods (polygons) and restaurants (points).</p>
<ul>
<li>Neighborhoods (x) contain restaurants (y), or</li>
<li>restaurants (x) are within neighborhoods (y).</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="from-people-to-built-environment.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Before joining, check if they have the same projections</span></span>
<span id="cb43-2"><a href="from-people-to-built-environment.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(sfnh) <span class="sc">==</span> <span class="fu">st_crs</span>(sf_sfbiz)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="from-people-to-built-environment.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform spatial join</span></span>
<span id="cb45-2"><a href="from-people-to-built-environment.html#cb45-2" aria-hidden="true" tabindex="-1"></a>nh_joined <span class="ot">&lt;-</span> <span class="fu">st_join</span>(<span class="at">x =</span> sfnh, <span class="co"># join</span></span>
<span id="cb45-3"><a href="from-people-to-built-environment.html#cb45-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> sf_sfbiz, <span class="co"># target</span></span>
<span id="cb45-4"><a href="from-people-to-built-environment.html#cb45-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">join =</span> st_contains, <span class="co"># does x(polygon) contains y(point)?</span></span>
<span id="cb45-5"><a href="from-people-to-built-environment.html#cb45-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">left =</span> <span class="cn">TRUE</span>) <span class="co"># keep all neighborhoods</span></span>
<span id="cb45-6"><a href="from-people-to-built-environment.html#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="from-people-to-built-environment.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Explore</span></span>
<span id="cb45-8"><a href="from-people-to-built-environment.html#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nh_joined, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Simple feature collection with 3 features and 10 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -122.4428 ymin: 37.77644 xmax: -122.4202 ymax: 37.79037
## Geodetic CRS:  WGS 84
##                nhood                      company       address_line_1
## 1   Western Addition                 HINATA SUSHI     810 VAN NESS AVE
## 1.1 Western Addition                  BURGER KING     819 VAN NESS AVE
## 1.2 Western Addition ISTITUTO ITALIANO DI CULTURA 601 VAN NESS AVE # F
##              city zipcode      naics8_descriptions employee_size_location
## 1   SAN FRANCISCO   94109 FULL-SERVICE RESTAURANTS                      6
## 1.1 SAN FRANCISCO   94109 FULL-SERVICE RESTAURANTS                     58
## 1.2 SAN FRANCISCO   94102 FULL-SERVICE RESTAURANTS                      6
##     sales_volume_location state                                       full_add
## 1                     427    CA     810 VAN NESS AVE, SAN FRANCISCO, CA, 94109
## 1.1                  2447    CA     819 VAN NESS AVE, SAN FRANCISCO, CA, 94109
## 1.2                   427    CA 601 VAN NESS AVE # F, SAN FRANCISCO, CA, 94102
##                           geometry
## 1   MULTIPOLYGON (((-122.4214 3...
## 1.1 MULTIPOLYGON (((-122.4214 3...
## 1.2 MULTIPOLYGON (((-122.4214 3...</code></pre>
</div>
<div id="data-visualization-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Data visualization<a href="from-people-to-built-environment.html#data-visualization-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To start, you can simply overlay the restaurant locations on top of the neighborhood map.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="from-people-to-built-environment.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the restaurant locations</span></span>
<span id="cb47-2"><a href="from-people-to-built-environment.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb47-3"><a href="from-people-to-built-environment.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># display neighborhood boundaries</span></span>
<span id="cb47-4"><a href="from-people-to-built-environment.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_joined,</span>
<span id="cb47-5"><a href="from-people-to-built-environment.html#cb47-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb47-6"><a href="from-people-to-built-environment.html#cb47-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.02</span>,</span>
<span id="cb47-7"><a href="from-people-to-built-environment.html#cb47-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb47-8"><a href="from-people-to-built-environment.html#cb47-8" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb47-9"><a href="from-people-to-built-environment.html#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># display restaurants</span></span>
<span id="cb47-10"><a href="from-people-to-built-environment.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_sfbiz, </span>
<span id="cb47-11"><a href="from-people-to-built-environment.html#cb47-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb47-12"><a href="from-people-to-built-environment.html#cb47-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb47-13"><a href="from-people-to-built-environment.html#cb47-13" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span>  <span class="co"># Plot restaurants</span></span>
<span id="cb47-14"><a href="from-people-to-built-environment.html#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb47-15"><a href="from-people-to-built-environment.html#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Restaurants in San Francisco&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/point-map-1.png" width="672" /></p>
<p>Taking a step further, we can create a choropleth map by counting the number of restaurants in each neighborhood.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="from-people-to-built-environment.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count restaurants per neighborhood</span></span>
<span id="cb48-2"><a href="from-people-to-built-environment.html#cb48-2" aria-hidden="true" tabindex="-1"></a>restaurant_counts <span class="ot">&lt;-</span> nh_joined <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="from-people-to-built-environment.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nhood) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="from-people-to-built-environment.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_rst =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(company)), <span class="co"># don&#39;t count NA as 1 </span></span>
<span id="cb48-5"><a href="from-people-to-built-environment.html#cb48-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="co"># avoid the nested structure of data</span></span>
<span id="cb48-6"><a href="from-people-to-built-environment.html#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="from-people-to-built-environment.html#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the choropleth map</span></span>
<span id="cb48-8"><a href="from-people-to-built-environment.html#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> restaurant_counts) <span class="sc">+</span></span>
<span id="cb48-9"><a href="from-people-to-built-environment.html#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> n_rst), <span class="co"># fill based on the restaurant count </span></span>
<span id="cb48-10"><a href="from-people-to-built-environment.html#cb48-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb48-11"><a href="from-people-to-built-environment.html#cb48-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-12"><a href="from-people-to-built-environment.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">type=</span><span class="st">&quot;seq&quot;</span>, </span>
<span id="cb48-13"><a href="from-people-to-built-environment.html#cb48-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>,</span>
<span id="cb48-14"><a href="from-people-to-built-environment.html#cb48-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="dv">1</span>,</span>
<span id="cb48-15"><a href="from-people-to-built-environment.html#cb48-15" aria-hidden="true" tabindex="-1"></a>                       ) <span class="sc">+</span></span>
<span id="cb48-16"><a href="from-people-to-built-environment.html#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb48-17"><a href="from-people-to-built-environment.html#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Restaurant Count&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/aggregate-map-1.png" width="672" /></p>
<p>When creating a choropleth map, it’s crucial to check the statistical distribution of the variable.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="from-people-to-built-environment.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(restaurant_counts<span class="sc">$</span>n_rst)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/histogram-1.png" width="672" /></p>
<p>There are various methods to determine how you classify colors. The most common methods are quantile binning, natural breaks (jenks), standard deviation, and custom breaks (defined by the researcher). Below, I use the custom breaks.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="from-people-to-built-environment.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom breaks</span></span>
<span id="cb50-2"><a href="from-people-to-built-environment.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> restaurant_counts) <span class="sc">+</span></span>
<span id="cb50-3"><a href="from-people-to-built-environment.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> n_rst), </span>
<span id="cb50-4"><a href="from-people-to-built-environment.html#cb50-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb50-5"><a href="from-people-to-built-environment.html#cb50-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb50-6"><a href="from-people-to-built-environment.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">type=</span><span class="st">&quot;seq&quot;</span>, </span>
<span id="cb50-7"><a href="from-people-to-built-environment.html#cb50-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>,</span>
<span id="cb50-8"><a href="from-people-to-built-environment.html#cb50-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">250</span>), <span class="co"># specify breaks</span></span>
<span id="cb50-9"><a href="from-people-to-built-environment.html#cb50-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="dv">1</span>,</span>
<span id="cb50-10"><a href="from-people-to-built-environment.html#cb50-10" aria-hidden="true" tabindex="-1"></a>                       ) <span class="sc">+</span></span>
<span id="cb50-11"><a href="from-people-to-built-environment.html#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb50-12"><a href="from-people-to-built-environment.html#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Restaurant Count&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/custom-map-1.png" width="672" /></p>
</div>
<div id="export-maps" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Export Maps<a href="from-people-to-built-environment.html#export-maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, let’s say you are ready export your maps for publication. We will publish a figure of two maps side by side, displaying two ways of visualizing the distribution of restaurant by neighborhood in San Francisco.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="from-people-to-built-environment.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and store maps</span></span>
<span id="cb51-2"><a href="from-people-to-built-environment.html#cb51-2" aria-hidden="true" tabindex="-1"></a>map1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="from-people-to-built-environment.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># display neighborhood boundaries</span></span>
<span id="cb51-4"><a href="from-people-to-built-environment.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sfnh,</span>
<span id="cb51-5"><a href="from-people-to-built-environment.html#cb51-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">&quot;lightgray&quot;</span>,</span>
<span id="cb51-6"><a href="from-people-to-built-environment.html#cb51-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.02</span>,</span>
<span id="cb51-7"><a href="from-people-to-built-environment.html#cb51-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span></span>
<span id="cb51-8"><a href="from-people-to-built-environment.html#cb51-8" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb51-9"><a href="from-people-to-built-environment.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># display restaurants</span></span>
<span id="cb51-10"><a href="from-people-to-built-environment.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_sfbiz, </span>
<span id="cb51-11"><a href="from-people-to-built-environment.html#cb51-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb51-12"><a href="from-people-to-built-environment.html#cb51-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb51-13"><a href="from-people-to-built-environment.html#cb51-13" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span>  <span class="co"># Plot restaurants</span></span>
<span id="cb51-14"><a href="from-people-to-built-environment.html#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb51-15"><a href="from-people-to-built-environment.html#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="from-people-to-built-environment.html#cb51-16" aria-hidden="true" tabindex="-1"></a>map2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> restaurant_counts) <span class="sc">+</span></span>
<span id="cb51-17"><a href="from-people-to-built-environment.html#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> n_rst), </span>
<span id="cb51-18"><a href="from-people-to-built-environment.html#cb51-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb51-19"><a href="from-people-to-built-environment.html#cb51-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb51-20"><a href="from-people-to-built-environment.html#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">type=</span><span class="st">&quot;seq&quot;</span>, </span>
<span id="cb51-21"><a href="from-people-to-built-environment.html#cb51-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>,</span>
<span id="cb51-22"><a href="from-people-to-built-environment.html#cb51-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">250</span>), <span class="co"># specify breaks</span></span>
<span id="cb51-23"><a href="from-people-to-built-environment.html#cb51-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="dv">1</span>,</span>
<span id="cb51-24"><a href="from-people-to-built-environment.html#cb51-24" aria-hidden="true" tabindex="-1"></a>                       ) <span class="sc">+</span></span>
<span id="cb51-25"><a href="from-people-to-built-environment.html#cb51-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb51-26"><a href="from-people-to-built-environment.html#cb51-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb51-27"><a href="from-people-to-built-environment.html#cb51-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-28"><a href="from-people-to-built-environment.html#cb51-28" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(map1, map2, <span class="at">ncol=</span><span class="dv">2</span>,</span>
<span id="cb51-29"><a href="from-people-to-built-environment.html#cb51-29" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Point Map&quot;</span>, <span class="st">&quot;Choropleth Map&quot;</span>))</span>
<span id="cb51-30"><a href="from-people-to-built-environment.html#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="from-people-to-built-environment.html#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="from-people-to-built-environment.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export the combined map</span></span>
<span id="cb52-2"><a href="from-people-to-built-environment.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;sf_restaurant_maps.png&quot;</span>, <span class="at">plot =</span> combined, </span>
<span id="cb52-3"><a href="from-people-to-built-environment.html#cb52-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">6</span>, </span>
<span id="cb52-4"><a href="from-people-to-built-environment.html#cb52-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span> <span class="co"># resolution</span></span>
<span id="cb52-5"><a href="from-people-to-built-environment.html#cb52-5" aria-hidden="true" tabindex="-1"></a>       )</span></code></pre></div>
<p>While it is not strictly expected in sociology papers, you can also add a north arrow and a scale bar to a map using the ggspatial package.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="from-people-to-built-environment.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="from-people-to-built-environment.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a scale bar and a north arrow </span></span>
<span id="cb54-2"><a href="from-people-to-built-environment.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> restaurant_counts) <span class="sc">+</span></span>
<span id="cb54-3"><a href="from-people-to-built-environment.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> n_rst), </span>
<span id="cb54-4"><a href="from-people-to-built-environment.html#cb54-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.2</span>,</span>
<span id="cb54-5"><a href="from-people-to-built-environment.html#cb54-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb54-6"><a href="from-people-to-built-environment.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">type =</span> <span class="st">&quot;seq&quot;</span>, </span>
<span id="cb54-7"><a href="from-people-to-built-environment.html#cb54-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">palette =</span> <span class="st">&quot;Greys&quot;</span>,</span>
<span id="cb54-8"><a href="from-people-to-built-environment.html#cb54-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">250</span>),</span>
<span id="cb54-9"><a href="from-people-to-built-environment.html#cb54-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb54-10"><a href="from-people-to-built-environment.html#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb54-11"><a href="from-people-to-built-environment.html#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Restaurant Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-12"><a href="from-people-to-built-environment.html#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a scale bar</span></span>
<span id="cb54-13"><a href="from-people-to-built-environment.html#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">&quot;bl&quot;</span>,  <span class="co"># &quot;br&quot; is for bottom right, adjust as needed</span></span>
<span id="cb54-14"><a href="from-people-to-built-environment.html#cb54-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">&quot;cm&quot;</span>) <span class="co"># place the scale bar close to the bottom</span></span>
<span id="cb54-15"><a href="from-people-to-built-environment.html#cb54-15" aria-hidden="true" tabindex="-1"></a>                   ) <span class="sc">+</span> </span>
<span id="cb54-16"><a href="from-people-to-built-environment.html#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a north arrow</span></span>
<span id="cb54-17"><a href="from-people-to-built-environment.html#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&quot;tl&quot;</span>,  <span class="co"># &quot;tl&quot; is for top left, adjust as needed</span></span>
<span id="cb54-18"><a href="from-people-to-built-environment.html#cb54-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">style =</span> north_arrow_fancy_orienteering)  </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/add-arrow-scale-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="emplacing-demographic-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="additional-topics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hyoon28/soc-gis-tutorial/edit/main/05-poi-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/hyoon28/soc-gis-tutorial/blob/main/05-poi-data.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
